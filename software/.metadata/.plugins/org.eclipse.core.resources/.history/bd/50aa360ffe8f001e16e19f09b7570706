#include "hw.h"


#define LCD_ROWS 2
#define LCD_COLS 16

#define BLANK      0x00
#define PLAYER     0xF6
#define ASTEROID_0 0x2A
#define ASTEROID_1 0xEF
#define ASTEROID_2 0xF2
#define BLACK_HOLE 0xFF

uint8_t game_matrix[LCD_ROWS][LCD_COLS];


void updateLCD(void);


int main(){
	uint8_t switch_data;
	initTimers();
	lcdInit();

	alt_putstr("Ciao from Nios II!\n");

	setTimer(GAME_TIMER, 10000);
	startTimer(GAME_TIMER);

	while(1) {
		clearSema(GAME_TIMER);
		while(getSema(GAME_TIMER) == 0){};
		switch_data = readSwitch();

		lcdClear();
		lcdSetAddr((~switch_data) & 0x01, 1);
		lcdWrite(0xF6);
	}

	return 0;
}


void updateLCD(void){
	static uint8_t prevFrame[LCD_ROWS][LCD_COLS] = {
			{BLANK, BLANK,  BLANK, BLANK, BLANK, BLANK, BLANK, BLANK, BLANK, BLANK, BLANK, BLANK, BLANK, BLANK, BLANK, BLANK},
			{BLANK, PLAYER, BLANK, BLANK, BLANK, BLANK, BLANK, BLANK, BLANK, BLANK, BLANK, BLANK, BLANK, BLANK, BLANK, BLANK}
	};





	for(int i = 0; i < LCD_ROWS; i++){
		for(int j = 0; j < LCD_COLS; j++){
			prevFrame[i][j] = game_matrix[i][j];
		}
	}
}
